<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>VirtualCurator</title>
    <meta name="description" content="An immersive experience where users can explore and interact with different art pieces and environments written by ChatGPT.">
    <script src="aframe.min.js"></script>
    <style>

      hr {
        border: 1px dashed #ccc;
        margin: 2em 0;
      }
      .drop-zone {
        position: fixed;
        width: 50%;
        height: 100%;
        border: dashed 4px #888;
        background-color: rgba(255, 255, 255, 0.5);
        display: none;
      }
      #drop-zone-model {
        top: 0;
        left: 0;
      }
      #drop-zone-environment {
        top: 0;
        right: 0;
      }

      #floating-menu,
      #floating-menu-load,
      #floating-info-box{
        position: fixed;
        top: 10px;
        right: 10px;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      #floating-menu-load {
        left:10px;
        right:auto;
      }
      #floating-menu-load .menu-button {
        background-color: #79ce12;
      }

      #floating-info-box {
        bottom:10px;
        left:10px;
        top:auto;
        font-size: 10px;
        color:#222;
      }
      #floating-info-box p {
        margin:0;
      }
      #floating-info-box p+p{
        margin-top:0.75em;
      }
      .menu-button {
        background-color: #4cc3d9;
        border: none;
        color: white;
        padding: 5px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }

      #floating-menu-load .menu-button.red{
        background-color: #ff2266;
      }
      #floating-menu-load .menu-button.share{
        background-color: #22eecc;
      }
      #floating-menu-load .menu-button.dark {
        background-color:#0b292f;
      }

      #floating-info-box {
        background-color: rgba(255, 255, 255, 0.3);
        padding: 10px;
        border-radius: 5px;
        max-width: 200px;
      }

      #move-light-button {
        position: fixed;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #4cc3d9;
        border: none;
        color: white;
        padding: 5px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }

       #popup-window,
       #popup-window-share{
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      .popup-content {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }
      .popup-content button {
        background-color: #4cc3d9;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 4px;
      }

      .popup-content button:disabled {
        background-color: #cccccc;
        color: #999999;
        cursor: not-allowed;
        opacity: 0.7;
      }

      .panel-drawer {
        position: fixed;
        bottom: 10px;
        left: 10px;
        background-color: white;
        padding: 10px;
        transition: max-height 0.3s;
        overflow: hidden;
        max-height: 40px;
      }

      .panel-drawer.expanded {
        max-height: 700px;
        width:812px;
      }

      .panel-drawer img {
        width:100px;
        opacity:0.5;
      }

      .panel-drawer .menu-button {
        background-color:#0b292f;
      }

      .panel-drawer button:hover img {
        opacity:1;
      }

      .sky-image-list {
        margin-top: 10px;
      }

      .sky-image-list button {
        margin:5px;
      }

      .sky-image-list ul {
        margin:0; padding:0;
      }

      .sky-image-list li {
        list-style:none;
        display:inline-block;
      }

      .hidden {
        display: none;
      }

      .image-title {
        margin: 5px 0 0;
        font-size: 12px;
        text-align: center;
      }


    </style>

  </head>
  <body>
    <div id="popup-window">
      <div class="popup-content">
        <h1>Welcome to VirtualCurator</h1>
        <p>Created by:</p>
        <p>OpenAI's ðŸ¤– ChatGPT &amp; ðŸ‘¤ Krzysztof Krystian Jankowski</p>
        <p><small>Special thanks to ðŸ‘¤ Monika MaÅ‚gorzata Trenerowska<br/>for testing and ideas.</small></p>
        <hr/>
        <button id="enter-app-btn" disabled>Loading...</button>
        <p><small>VERSION <span id="app-version"></span> // <span id="app-date"></span></small></p>
        <p><small>&copy;2023 P1X</small></p>
      </div>
    </div>

    <div id="popup-window-share" style="display:none;">
      <div class="popup-content">
        <h3>Share this URL:</h3>
        <p><input id="shareUrlInput" type="text" readonly></p>
        <button id="close-popup-share">Close</button>
      </div>
    </div>

    <a-scene loading-screen="dotsColor: black; backgroundColor: white"
             renderer="antialias:true; colorManagement:true; physicallyCorrectLights:true; toneMapping:ACESFilmic; highRefreshRate:true;"
             shadow="castShadow:true; type:pcfsoft;"
             reflection>
      <a-sky id="hdr-sky" radius="300"></a-sky>

      <!-- Camera setup -->
      <a-entity id="cameraRig" movement-controls="speed: 0.1" position="0 1.6 3">
        <a-entity id="camera" camera position="0 0 0" camera-transform-updater></a-entity>
        <a-entity id="left-hand" oculus-touch-controls="hand: left" laser-controls="hand: left" raycaster="objects: .teleportable" teleport-controls="cameraRig: cameraRig; teleportOrigin: #camera; button: trackpad;" buttons-events></a-entity>
      <a-entity id="right-hand" laser-controls="hand: right"  oculus-touch-controls="hand: right" raycaster="objects: .teleportable" teleport-controls="cameraRig: cameraRig; teleportOrigin: #camera;" buttons-events></a-entity>
      </a-entity>



      <a-entity id="customModel" position="0 1 0" scale="1 1 1" shadow="receive:true; cast:true;"></a-entity>
      <a-entity id="customEnvironment" position="0 0 0" scale="1 1 1" shadow="receive:true; cast:false;"></a-entity>

      <!-- Lighting -->
      <a-light id="light1" position="-2 4 0" light="type:directional; castShadow:true; color:#FFF; intensity:4; target:#customModel; angle:30;"></a-light>
      <a-light id="light2" position="2 4 0" light="type:directional; castShadow:true; color:#FFF; intensity:4; target:#customModel; angle:30;"></a-light>
      <a-light id="light3" position="2 3 2" light="type:directional; castShadow:true; color:#FFF; intensity:4; target:#customModel; angle:160;"></a-light>
      <a-light type="ambient" color="#AAA" intensity="1"></a-light>
    </a-scene>

    <div id="floating-menu">

      <a class="menu-button" href="models/p1x.glb" download="p1x.glb">Download P1X model</a>
      <a class="menu-button" href="environments/a-vr-enviro-1.glb" download="a-vr-enviro-1.glb">Download Environment 1</a>
      <a class="menu-button" href="environments/a-vr-enviro-2.glb" download="a-vr-enviro-2.glb">Download Environment 2</a>
    </div>

    <div id="floating-menu-load">
      <button class="menu-button dark" id="reset-view-btn">Reset View</button>
      <button class="menu-button red" id="restore-controls" style="display:none;">RESTORE CAMERA CONTROLS</button>
      <button class="menu-button" id="load-model">Load next model</button>
      <button class="menu-button" id="load-enviro">Load next environment</button>
      <button class="menu-button" id="load-sky">Load next sky</button>
      <button  class="menu-button share" id="share-view">Share view</button>
    </div>

    <button id="move-light-button">Move Light</button>

    <div id="panelDrawer" class="panel-drawer collapsed">
      <button id="expandButton" class="menu-button">Toggle available skys</button>
      <div id="skyImageList" class="sky-image-list hidden">
        <p>Those are test skyboxes created using Stable Diffusion. I will choose the best styles and generate final skys.</p>
        <ul></ul>
      </div>
    </div>


    <div id="drop-zone-model" class="drop-zone">
      <h1 style="text-align: center; margin-top: 40%;">Drop your model .glb file here</h1>
    </div>
    <div id="drop-zone-environment" class="drop-zone">
      <h1 style="text-align: center; margin-top: 40%;">Drop your environment .glb file here</h1>
    </div>

    <script>
      const appVersion = 7;
      const appDate = "24-03-2023";

      let skyImages, environmentImages, modelImages;
      let currentEnvironmentIndex = 0;
      let currentSkyIndex = 0;
      let currentModelIndex = 0;

      async function loadImagesData() {
        const response = await fetch('imagesData.json');
        const data = await response.json();

        return data;
      }

      loadImagesData().then((data) => {
        skyImages = data.skyImages;
        environmentImages = data.environmentImages;
        modelImages = data.modelImages;

        populateSkyImageList();
        // populateEnvironmentList();
        // populateModelList();
        loadCameraTransformFromUrlHash();
        loadModelFromUrlHash();
        loadEnvironmentFromUrlHash();
        loadSkyFromUrlHash();
        applyLightPositionsFromHash();
        enableEnterAppButton();
      });

      const dropZoneModel = document.getElementById('drop-zone-model');
      const dropZoneEnvironment = document.getElementById('drop-zone-environment');

      function updateVersion(){
        document.getElementById('app-version').innerHTML = appVersion;
        document.getElementById('app-date').innerHTML = appDate;
      };

      function enableEnterAppButton() {
        const enterAppButton = document.getElementById('enter-app-btn');
        enterAppButton.textContent = 'Enter the App';
        enterAppButton.removeAttribute('disabled');
      }

      function loadModel(url) {
        const model = document.getElementById('customModel');
        model.setAttribute('gltf-model', url);
      }

      function loadModelFromUrlHash() {
        const params = new URLSearchParams(window.location.hash.slice(1));
        const modelFilename = params.get('model');

        if (modelFilename) {
          const modelUrl = `models/${modelFilename}.glb`;
          loadModel(modelUrl);
        } else {
          loadModel(modelImages[currentModelIndex].url);
        }
      }


        function loadNextModel() {
          currentModelIndex = (currentModelIndex + 1) % modelImages.length;
          const nextModelUrl = modelImages[currentModelIndex].url;
          loadModel(nextModelUrl);

          // Update the URL's hash
          const params = new URLSearchParams(window.location.hash.slice(1));
          const nextModelFilename = nextModelUrl.split('/').pop().split('.')[0];
          params.set('model', nextModelFilename);
          window.location.hash = params.toString();
        }


      function loadEnvironment(url) {
        const environment = document.getElementById('customEnvironment');
        environment.setAttribute('gltf-model', url);
      }

      function loadEnvironmentFromUrlHash() {
        const params = new URLSearchParams(window.location.hash.slice(1));
        const environmentFilename = params.get('environment');

        if (environmentFilename) {
          const environmentUrl = `environments/${environmentFilename}.glb`;
          loadEnvironment(environmentUrl);
        } else {
          loadEnvironment(environmentImages[currentEnvironmentIndex].url);
        }
      }


      function loadNextSky() {
        currentSkyIndex = (currentSkyIndex + 1) % skyImages.length;
        const nextSkyUrl = skyImages[currentSkyIndex].url;
        loadSky(nextSkyUrl);

        // Update the URL's hash
        const params = new URLSearchParams(window.location.hash.slice(1));
        const nextSkyFilename = nextSkyUrl.split('/').pop().split('.')[0];
        params.set('sky', nextSkyFilename);
        window.location.hash = params.toString();
      }

      function loadExactSky(url) {
        loadSky(url);

        // Update the URL's hash
        const params = new URLSearchParams(window.location.hash.slice(1));
        const nextSkyFilename = url.split('/').pop().split('.')[0];
        params.set('sky', nextSkyFilename);
        window.location.hash = params.toString();
      }

      function loadNextEnvironment() {
        currentEnvironmentIndex = (currentEnvironmentIndex + 1) % environmentImages.length;
        const nextEnvironmentUrl = environmentImages[currentEnvironmentIndex].url;
        loadEnvironment(nextEnvironmentUrl);

        // Update the URL's hash
        const params = new URLSearchParams(window.location.hash.slice(1));
        const nextEnvironmentFilename = nextEnvironmentUrl.split('/').pop().split('.')[0];
        params.set('environment', nextEnvironmentFilename);
        window.location.hash = params.toString();
      }



      document.getElementById('load-model').addEventListener('click', () => {
        loadNextModel();
      });

      document.getElementById('load-enviro').addEventListener('click', () => {
       loadNextEnvironment();
      });

      document.getElementById('load-sky').addEventListener('click', () => {
        loadNextSky();
      });

      document.getElementById('restore-controls').addEventListener('click', () => {
        restoreCameraControls();
      });

      document.getElementById('share-view').addEventListener('click', () => {
        togglePopupWindowShare();
      });

      document.getElementById('close-popup-share').addEventListener('click', () => {
        togglePopupWindowShare();
      });


      document.addEventListener('dragover', (event) => {
        event.preventDefault();
        dropZoneModel.style.display = 'block';
        dropZoneEnvironment.style.display = 'block';
      });

      dropZoneModel.addEventListener('dragleave', (event) => {
        event.preventDefault();
        dropZoneModel.style.display = 'none';
      });

      dropZoneEnvironment.addEventListener('dragleave', (event) => {
        event.preventDefault();
        dropZoneEnvironment.style.display = 'none';
      });

      dropZoneModel.addEventListener('drop', async (event) => {
        event.preventDefault();
        dropZoneModel.style.display = 'none';
        dropZoneEnvironment.style.display = 'none';

        const file = event.dataTransfer.files[0];
        if (file && file.name.endsWith('.glb')) {
          const modelURL = URL.createObjectURL(file);
          const modelEntity = document.getElementById('customModel');
          modelEntity.setAttribute('gltf-model', modelURL);
        }
      });

      dropZoneEnvironment.addEventListener('drop', async (event) => {
        event.preventDefault();
        dropZoneModel.style.display = 'none';
        dropZoneEnvironment.style.display = 'none';

        const file = event.dataTransfer.files[0];
        if (file && file.name.endsWith('.glb')) {
          const environmentURL = URL.createObjectURL(file);
          const environmentEntity = document.getElementById('customEnvironment');
          environmentEntity.setAttribute('gltf-model', environmentURL);
        }
      });

      function randomPosition(radius) {
        const angle = Math.random() * 2 * Math.PI;
        const x = radius * Math.cos(angle);
        const y = radius * Math.sin(angle);
        const z = radius * Math.sin(angle);
        return { x, y, z };
      }

      function moveLights(lightIds) {
        const lightPositions = parseLightPositionsFromHash();

        lightIds.forEach((lightId) => {
          const light = document.getElementById(lightId);
          if (!light) return;

          const currentPosition = light.getAttribute('position');
          const newPosition = randomPosition(8);
          light.setAttribute('animation', {
            property: 'position',
            from: `${currentPosition.x} ${currentPosition.y} ${currentPosition.z}`,
            to: `${newPosition.x} ${newPosition.y} ${newPosition.z}`,
            dur: 3000,
            easing: 'easeInOutQuad',
          });

          // Update the light positions object
          lightPositions[lightId] = [newPosition.x, newPosition.y, newPosition.z];
        });

        // Update the URL's hash
        const params = new URLSearchParams(window.location.hash.slice(1));
        Object.entries(lightPositions).forEach(([key, value]) => {
          params.set(key, value.join(','));
        });
        window.location.hash = params.toString();
      }

      function applyLightPositionsFromHash() {
        const lightPositions = parseLightPositionsFromHash();
        Object.entries(lightPositions).forEach(([lightId, position]) => {
          const light = document.getElementById(lightId);
          if (light) {
            light.setAttribute('position', { x: position[0], y: position[1], z: position[2] });
          }
        });
      }

      document.getElementById('move-light-button').addEventListener('click', () => {
        moveLights(['light1', 'light2', 'light3']);
      });

      function loadSky(url) {
        const sky = document.querySelector('a-sky');
        sky.setAttribute('src', url);
      }

      AFRAME.registerComponent('buttons-events',{
        init: function () {
          this.el.addEventListener('abuttondown', this.changeSky);
          this.el.addEventListener('bbuttondown', this.changeLight);
          this.el.addEventListener('xbuttondown', this.changeModel);
          this.el.addEventListener('ybuttondown', this.changeEnviro);
        },
        changeSky: function(){
            loadNextSky()
        },
        changeLight: function(){
            moveLights(['light1', 'light2', 'light3']);
        },
        changeModel: function(){
            loadNextModel();
        },
        changeEnviro: function(){
            loadNextEnvironment();
        }
      });

      function loadSkyFromUrlHash() {
        const params = new URLSearchParams(window.location.hash.slice(1));
        const skyFilename = params.get('sky');

        if (skyFilename) {
          const skyUrl = `skys/${skyFilename}.jpg`;
          loadSky(skyUrl);
        }
      }


      function parseLightPositionsFromHash() {
        const hash = window.location.hash.slice(1);
        const params = new URLSearchParams(hash);

        const lightPositions = {};
        params.forEach((value, key) => {
          if (key.startsWith('light')) {
            lightPositions[key] = value.split(',').map(parseFloat);
          }
        });

        return lightPositions;
      }

      function restoreCameraControls(){
        const camera = document.querySelector('#camera');
        const restore = document.querySelector('#restore-controls');
        camera.setAttribute('wasd-controls', '');
        camera.setAttribute('look-controls', '');
        camera.setAttribute('camera-keyboard-controls', '');

        restore.style.display="none";
      }

      function loadCameraTransformFromUrlHash() {
        const params = new URLSearchParams(window.location.hash.slice(1));
        const cameraPositionString = params.get('cameraPosition');
        const cameraRotationString = params.get('cameraRotation');

        const camera = document.querySelector('#camera');
        const restore = document.querySelector('#restore-controls');
        if (cameraPositionString) {
          const cameraPosition = AFRAME.utils.coordinates.parse(cameraPositionString);
          camera.setAttribute('position', cameraPosition);
          restore.style.display="block";
        } else {
          restoreControls();
          restoreLook();
        }

        if (cameraRotationString) {
          const cameraRotation = AFRAME.utils.coordinates.parse(cameraRotationString);
          camera.setAttribute('rotation', cameraRotation);
          restore.style.display="block";
        }else{
          restoreLook();
        }
      }

      function blockControls(){
        const camera = document.querySelector('#camera');
        camera.removeAttribute('wasd-controls');
        camera.removeAttribute('camera-keyboard-controls');

      }

      function blockLook(){
        camera.removeAttribute('look-controls');
      }

      function restoreControls(){
        const camera = document.querySelector('#camera');
        camera.setAttribute('wasd-controls', '');
        camera.setAttribute('camera-keyboard-controls', '');

      }

      function restoreLook(){
        camera.setAttribute('look-controls', '');
      }

      AFRAME.registerComponent('camera-transform-updater', {
        schema: {
          tickTimeout: { type: 'int', default: 1000 }
        },

        init: function () {
          this.previousPosition = this.el.getAttribute('position');
          this.previousRotation = this.el.getAttribute('rotation');
          this.lastUpdate = performance.now();
        },

        tick: function (time) {
          const currentPosition = this.el.getAttribute('position');
          const currentRotation = this.el.getAttribute('rotation');
          const timeSinceLastUpdate = time - this.lastUpdate;
          const shouldUpdateHash = timeSinceLastUpdate >= this.data.tickTimeout;

          if (shouldUpdateHash &&
              (AFRAME.utils.deepEqual(this.previousPosition, currentPosition) ||
              AFRAME.utils.deepEqual(this.previousRotation, currentRotation))) {

            const params = new URLSearchParams(window.location.hash.slice(1));
            params.set('cameraPosition', AFRAME.utils.coordinates.stringify(currentPosition));
            params.set('cameraRotation', AFRAME.utils.coordinates.stringify(currentRotation));
            window.location.hash = params.toString();

            this.previousPosition = currentPosition;
            this.previousRotation = currentRotation;
            this.lastUpdate = time;
          }
        }
      });

      AFRAME.registerComponent('camera-keyboard-controls', {
        init: function () {
          this.onKeyDown = this.onKeyDown.bind(this);
          this.onKeyUp = this.onKeyUp.bind(this);
          this.keysPressed = new Set();
        },

        play: function () {
          window.addEventListener('keydown', this.onKeyDown);
          window.addEventListener('keyup', this.onKeyUp);
        },

        pause: function () {
          window.removeEventListener('keydown', this.onKeyDown);
          window.removeEventListener('keyup', this.onKeyUp);
        },

        tick: function (time, deltaTime) {
          this.updateCameraPosition(deltaTime);
        },

        onKeyDown: function (event) {
          this.keysPressed.add(event.key);
        },

        onKeyUp: function (event) {
          this.keysPressed.delete(event.key);
        },

        updateCameraPosition: function (deltaTime) {
          if (this.keysPressed.size === 0) {
            return;
          }

          const position = this.el.getAttribute('position');
          const speed = 2; // Adjust the speed value to your preference
          const delta = deltaTime / 1000;

          if (this.keysPressed.has('e')) {
            position.y += speed * delta;
          }
          if (this.keysPressed.has('q')) {
            position.y -= speed * delta;
          }

          this.el.setAttribute('position', position);
        }
      });


      function togglePopupWindowShare() {
        const popupShare = document.querySelector('#popup-window-share');
        const shareUrlInput = document.querySelector('#shareUrlInput');
        const isVisible = popupShare.style.display === "flex";

        if (isVisible) {
          popupShare.style.display="none";
          restoreControls();
        } else {
          blockControls();
          shareUrlInput.value = window.location.href;
          popupShare.style.display="flex";
          shareUrlInput.select();
        }
      }

      function togglePanelDrawer() {
        const panelDrawer = document.querySelector('#panelDrawer');
        const skyImageList = document.querySelector('#skyImageList');
        const isExpanded = panelDrawer.classList.toggle('expanded');

        if (isExpanded) {
          skyImageList.classList.remove('hidden');
        } else {
          skyImageList.classList.add('hidden');
        }
      }


      function populateSkyImageList() {
        const skyImageList = document.querySelector('#skyImageList ul');

        skyImages.forEach((skyImage) => {
          const listItem = document.createElement('li');
          const button = document.createElement('button');
          const img = document.createElement('img');
          const title = document.createElement('p');

          button.dataset.skyUrl = skyImage.url;
          button.classList.add('menu-button');
          img.src = skyImage.url;
          img.alt = skyImage.alt;
          title.textContent = skyImage.alt;
          title.classList.add('image-title');

          button.appendChild(img);
          button.appendChild(title);
          listItem.appendChild(button);
          skyImageList.appendChild(listItem);

          // Add event listener for the button
          button.addEventListener('click', () => {
            loadExactSky(skyImage.url);
          });
        });
      }

      function resetView() {
        window.location.hash = '';

        currentEnvironmentIndex = 0;
        currentSkyIndex = -1;
        currentModelIndex = 0;

        loadEnvironment(environmentImages[currentEnvironmentIndex].url);
        loadModel(modelImages[currentModelIndex].url);

        document.querySelector('a-sky').setAttribute('src', '');

        blockLook();
        const camera = document.querySelector('#camera');
        const cameraPosition = AFRAME.utils.coordinates.parse("0 0 0");
        const cameraRotation = AFRAME.utils.coordinates.parse("0 0 0");
        camera.setAttribute('position', cameraPosition);
        camera.setAttribute('rotation', cameraRotation);
        restoreLook();
        restoreControls();
        document.querySelector('#restore-controls').style.display="none";
      }

      document.getElementById('reset-view-btn').addEventListener('click', resetView);

      document.querySelector('#expandButton').addEventListener('click', togglePanelDrawer);

      document.getElementById('enter-app-btn').addEventListener('click', () => {
        document.getElementById('popup-window').style.display = 'none';
      });

      function handleMouseScroll(event) {
        const camera = document.getElementById('camera');
        const currentFOV = camera.getAttribute('camera').fov;

        // Adjust the FOV based on the scroll direction
        let newFOV = currentFOV - event.deltaY * 0.1;

        // Limit the FOV to a reasonable range, e.g., between 20 and 100
        newFOV = Math.max(20, Math.min(100, newFOV));

        // Set the new FOV
        camera.setAttribute('camera', 'fov', newFOV);
      }

      window.addEventListener('wheel', handleMouseScroll);


      function startTitleScrolling() {
        const baseTitle = "VirtualCurator";
        const scrollText = " - Welcome to the VirtualCurator app! Enjoy your experience. ";
        let currentScrollPosition = 0;

        function updateTitleScroll() {
          const visibleText = scrollText.substr(currentScrollPosition, 10);
          document.title = baseTitle + visibleText;

          // Increment the current scroll position and wrap around if it exceeds the length of the scrollText
          currentScrollPosition = (currentScrollPosition + 1) % scrollText.length;
        }

        const scrollInterval = 300; // Scroll speed in milliseconds
        setInterval(updateTitleScroll, scrollInterval);
      }

      function supportsWebWorkers() {
        return typeof Worker !== "undefined";
      }

      if (supportsWebWorkers()) {
        const titleWorker = new Worker("title-worker.js");

        titleWorker.onmessage = (event) => {
          document.title = event.data;
        };
      } else {
        console.log("Web workers not supported.");
        startTitleScrolling();
      }


      updateVersion();
    </script>
  </body>
</html>
